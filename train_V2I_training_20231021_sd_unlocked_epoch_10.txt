ModelCheckpoint(save_last=True, save_top_k=-1, monitor=None) will duplicate the last checkpoint saved.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
/home/u5832291/anaconda3/envs/control/lib/python3.8/site-packages/pytorch_lightning/trainer/configuration_validator.py:280: LightningDeprecationWarning: Base `LightningModule.on_train_batch_start` hook signature has changed in v1.5. The `dataloader_idx` argument will be removed in v1.7.
  rank_zero_deprecation(
/home/u5832291/anaconda3/envs/control/lib/python3.8/site-packages/pytorch_lightning/trainer/configuration_validator.py:287: LightningDeprecationWarning: Base `Callback.on_train_batch_end` hook signature has changed in v1.5. The `dataloader_idx` argument will be removed in v1.7.
  rank_zero_deprecation(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Set SLURM handle signals.

  | Name              | Type               | Params
---------------------------------------------------------
0 | model             | DiffusionWrapper   | 859 M 
1 | first_stage_model | AutoencoderKL      | 83.7 M
2 | cond_stage_model  | FrozenCLIPEmbedder | 123 M 
3 | control_model     | ControlNet         | 361 M 
---------------------------------------------------------
1.2 B     Trainable params
206 M     Non-trainable params
1.4 B     Total params
5,710.058 Total estimated model params size (MB)
/home/u5832291/anaconda3/envs/control/lib/python3.8/site-packages/pytorch_lightning/utilities/data.py:56: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 4. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:   2%|▏         | 1/50 [00:01<01:20,  1.65s/it][A
DDIM Sampler:   4%|▍         | 2/50 [00:01<00:37,  1.27it/s][A
DDIM Sampler:   6%|▌         | 3/50 [00:02<00:23,  1.96it/s][A
DDIM Sampler:   8%|▊         | 4/50 [00:02<00:17,  2.64it/s][A
DDIM Sampler:  10%|█         | 5/50 [00:02<00:13,  3.25it/s][A
DDIM Sampler:  12%|█▏        | 6/50 [00:02<00:11,  3.79it/s][A
DDIM Sampler:  14%|█▍        | 7/50 [00:02<00:10,  4.23it/s][A
DDIM Sampler:  16%|█▌        | 8/50 [00:02<00:09,  4.57it/s][A
DDIM Sampler:  18%|█▊        | 9/50 [00:03<00:08,  4.83it/s][A
DDIM Sampler:  20%|██        | 10/50 [00:03<00:07,  5.03it/s][A
DDIM Sampler:  22%|██▏       | 11/50 [00:03<00:07,  5.18it/s][A
DDIM Sampler:  24%|██▍       | 12/50 [00:03<00:07,  5.29it/s][A
DDIM Sampler:  26%|██▌       | 13/50 [00:03<00:06,  5.36it/s][A
DDIM Sampler:  28%|██▊       | 14/50 [00:03<00:06,  5.42it/s][A
DDIM Sampler:  30%|███       | 15/50 [00:04<00:06,  5.46it/s][A
DDIM Sampler:  32%|███▏      | 16/50 [00:04<00:06,  5.49it/s][A
DDIM Sampler:  34%|███▍      | 17/50 [00:04<00:05,  5.51it/s][A
DDIM Sampler:  36%|███▌      | 18/50 [00:04<00:05,  5.52it/s][A
DDIM Sampler:  38%|███▊      | 19/50 [00:04<00:05,  5.51it/s][A
DDIM Sampler:  40%|████      | 20/50 [00:05<00:05,  5.51it/s][A
DDIM Sampler:  42%|████▏     | 21/50 [00:05<00:05,  5.51it/s][A
DDIM Sampler:  44%|████▍     | 22/50 [00:05<00:05,  5.50it/s][A
DDIM Sampler:  46%|████▌     | 23/50 [00:05<00:04,  5.52it/s][A
DDIM Sampler:  48%|████▊     | 24/50 [00:05<00:04,  5.52it/s][A
DDIM Sampler:  50%|█████     | 25/50 [00:05<00:04,  5.53it/s][A
DDIM Sampler:  52%|█████▏    | 26/50 [00:06<00:04,  5.53it/s][A
DDIM Sampler:  54%|█████▍    | 27/50 [00:06<00:04,  5.53it/s][A
DDIM Sampler:  56%|█████▌    | 28/50 [00:06<00:03,  5.54it/s][A
DDIM Sampler:  58%|█████▊    | 29/50 [00:06<00:03,  5.54it/s][A
DDIM Sampler:  60%|██████    | 30/50 [00:06<00:03,  5.54it/s][A
DDIM Sampler:  62%|██████▏   | 31/50 [00:07<00:03,  5.55it/s][A
DDIM Sampler:  64%|██████▍   | 32/50 [00:07<00:03,  5.53it/s][A
DDIM Sampler:  66%|██████▌   | 33/50 [00:07<00:03,  5.53it/s][A
DDIM Sampler:  68%|██████▊   | 34/50 [00:07<00:02,  5.51it/s][A
DDIM Sampler:  70%|███████   | 35/50 [00:07<00:02,  5.50it/s][A
DDIM Sampler:  72%|███████▏  | 36/50 [00:07<00:02,  5.51it/s][A
DDIM Sampler:  74%|███████▍  | 37/50 [00:08<00:02,  5.52it/s][A
DDIM Sampler:  76%|███████▌  | 38/50 [00:08<00:02,  5.53it/s][A
DDIM Sampler:  78%|███████▊  | 39/50 [00:08<00:01,  5.54it/s][A
DDIM Sampler:  80%|████████  | 40/50 [00:08<00:01,  5.54it/s][A
DDIM Sampler:  82%|████████▏ | 41/50 [00:08<00:01,  5.54it/s][A
DDIM Sampler:  84%|████████▍ | 42/50 [00:09<00:01,  5.55it/s][A
DDIM Sampler:  86%|████████▌ | 43/50 [00:09<00:01,  5.54it/s][A
DDIM Sampler:  88%|████████▊ | 44/50 [00:09<00:01,  5.54it/s][A
DDIM Sampler:  90%|█████████ | 45/50 [00:09<00:00,  5.53it/s][A
DDIM Sampler:  92%|█████████▏| 46/50 [00:09<00:00,  5.52it/s][A
DDIM Sampler:  94%|█████████▍| 47/50 [00:09<00:00,  5.52it/s][A
DDIM Sampler:  96%|█████████▌| 48/50 [00:10<00:00,  5.53it/s][A
DDIM Sampler:  98%|█████████▊| 49/50 [00:10<00:00,  5.53it/s][A
DDIM Sampler: 100%|██████████| 50/50 [00:10<00:00,  5.53it/s][ADDIM Sampler: 100%|██████████| 50/50 [00:10<00:00,  4.76it/s]