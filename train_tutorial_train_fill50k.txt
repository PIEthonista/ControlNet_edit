GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
/home/u5832291/anaconda3/envs/control/lib/python3.8/site-packages/pytorch_lightning/trainer/configuration_validator.py:118: UserWarning: You defined a `validation_step` but have no `val_dataloader`. Skipping val loop.
  rank_zero_warn("You defined a `validation_step` but have no `val_dataloader`. Skipping val loop.")
/home/u5832291/anaconda3/envs/control/lib/python3.8/site-packages/pytorch_lightning/trainer/configuration_validator.py:280: LightningDeprecationWarning: Base `LightningModule.on_train_batch_start` hook signature has changed in v1.5. The `dataloader_idx` argument will be removed in v1.7.
  rank_zero_deprecation(
/home/u5832291/anaconda3/envs/control/lib/python3.8/site-packages/pytorch_lightning/trainer/configuration_validator.py:287: LightningDeprecationWarning: Base `Callback.on_train_batch_end` hook signature has changed in v1.5. The `dataloader_idx` argument will be removed in v1.7.
  rank_zero_deprecation(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Set SLURM handle signals.

  | Name              | Type               | Params
---------------------------------------------------------
0 | model             | DiffusionWrapper   | 859 M 
1 | first_stage_model | AutoencoderKL      | 83.7 M
2 | cond_stage_model  | FrozenCLIPEmbedder | 123 M 
3 | control_model     | ControlNet         | 361 M 
---------------------------------------------------------
1.2 B     Trainable params
206 M     Non-trainable params
1.4 B     Total params
5,710.058 Total estimated model params size (MB)
/home/u5832291/anaconda3/envs/control/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:110: UserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 36 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/home/u5832291/anaconda3/envs/control/lib/python3.8/site-packages/pytorch_lightning/utilities/data.py:56: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 4. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:   2%|▏         | 1/50 [00:00<00:41,  1.17it/s][A
DDIM Sampler:   4%|▍         | 2/50 [00:01<00:41,  1.17it/s][A
DDIM Sampler:   6%|▌         | 3/50 [00:02<00:40,  1.17it/s][A
DDIM Sampler:   8%|▊         | 4/50 [00:03<00:39,  1.17it/s][A
DDIM Sampler:  10%|█         | 5/50 [00:04<00:38,  1.17it/s][A
DDIM Sampler:  12%|█▏        | 6/50 [00:05<00:37,  1.17it/s][A
DDIM Sampler:  14%|█▍        | 7/50 [00:05<00:36,  1.17it/s][A
DDIM Sampler:  16%|█▌        | 8/50 [00:06<00:35,  1.17it/s][A
DDIM Sampler:  18%|█▊        | 9/50 [00:07<00:35,  1.17it/s][A
DDIM Sampler:  20%|██        | 10/50 [00:08<00:34,  1.17it/s][A
DDIM Sampler:  22%|██▏       | 11/50 [00:09<00:33,  1.17it/s][A
DDIM Sampler:  24%|██▍       | 12/50 [00:10<00:32,  1.17it/s][A
DDIM Sampler:  26%|██▌       | 13/50 [00:11<00:31,  1.17it/s][A
DDIM Sampler:  28%|██▊       | 14/50 [00:11<00:30,  1.17it/s][A
DDIM Sampler:  30%|███       | 15/50 [00:12<00:29,  1.17it/s][A
DDIM Sampler:  32%|███▏      | 16/50 [00:13<00:29,  1.17it/s][A
DDIM Sampler:  34%|███▍      | 17/50 [00:14<00:28,  1.17it/s][A
DDIM Sampler:  36%|███▌      | 18/50 [00:15<00:27,  1.17it/s][A
DDIM Sampler:  38%|███▊      | 19/50 [00:16<00:26,  1.17it/s][A
DDIM Sampler:  40%|████      | 20/50 [00:17<00:25,  1.17it/s][A
DDIM Sampler:  42%|████▏     | 21/50 [00:17<00:24,  1.17it/s][A
DDIM Sampler:  44%|████▍     | 22/50 [00:18<00:23,  1.17it/s][A
DDIM Sampler:  46%|████▌     | 23/50 [00:19<00:23,  1.17it/s][A
DDIM Sampler:  48%|████▊     | 24/50 [00:20<00:22,  1.17it/s][A
DDIM Sampler:  50%|█████     | 25/50 [00:21<00:21,  1.17it/s][A
DDIM Sampler:  52%|█████▏    | 26/50 [00:22<00:20,  1.17it/s][A
DDIM Sampler:  54%|█████▍    | 27/50 [00:23<00:19,  1.17it/s][A
DDIM Sampler:  56%|█████▌    | 28/50 [00:23<00:18,  1.17it/s][A
DDIM Sampler:  58%|█████▊    | 29/50 [00:24<00:17,  1.17it/s][A
DDIM Sampler:  60%|██████    | 30/50 [00:25<00:17,  1.17it/s][A
DDIM Sampler:  62%|██████▏   | 31/50 [00:26<00:16,  1.17it/s][A
DDIM Sampler:  64%|██████▍   | 32/50 [00:27<00:15,  1.17it/s][A
DDIM Sampler:  66%|██████▌   | 33/50 [00:28<00:14,  1.17it/s][A
DDIM Sampler:  68%|██████▊   | 34/50 [00:29<00:13,  1.17it/s][A
DDIM Sampler:  70%|███████   | 35/50 [00:29<00:12,  1.17it/s][A
DDIM Sampler:  72%|███████▏  | 36/50 [00:30<00:11,  1.17it/s][A
DDIM Sampler:  74%|███████▍  | 37/50 [00:31<00:11,  1.17it/s][A
DDIM Sampler:  76%|███████▌  | 38/50 [00:32<00:10,  1.17it/s][A
DDIM Sampler:  78%|███████▊  | 39/50 [00:33<00:09,  1.17it/s][A
DDIM Sampler:  80%|████████  | 40/50 [00:34<00:08,  1.17it/s][A
DDIM Sampler:  82%|████████▏ | 41/50 [00:35<00:07,  1.17it/s][A
DDIM Sampler:  84%|████████▍ | 42/50 [00:35<00:06,  1.17it/s][A
DDIM Sampler:  86%|████████▌ | 43/50 [00:36<00:05,  1.17it/s][A
DDIM Sampler:  88%|████████▊ | 44/50 [00:37<00:05,  1.17it/s][A
DDIM Sampler:  90%|█████████ | 45/50 [00:38<00:04,  1.17it/s][A
DDIM Sampler:  92%|█████████▏| 46/50 [00:39<00:03,  1.17it/s][A
DDIM Sampler:  94%|█████████▍| 47/50 [00:40<00:02,  1.17it/s][A
DDIM Sampler:  96%|█████████▌| 48/50 [00:41<00:01,  1.17it/s][A
DDIM Sampler:  98%|█████████▊| 49/50 [00:41<00:00,  1.17it/s][A
DDIM Sampler: 100%|██████████| 50/50 [00:42<00:00,  1.17it/s][ADDIM Sampler: 100%|██████████| 50/50 [00:42<00:00,  1.17it/s]